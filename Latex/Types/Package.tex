\section{BPX Type: Package ('P')}

\subsection{Overview}
The Package BPX is using 'P' as the type byte of BPX Main Header. This type provides asset packages using the BPX format.
\newline
Below is a table describing the different sections to be expected in a BPXP:
\bpxsectiontable
{
    Data & 1 & Yes & No \\
    Metadata & 254 & No & Yes \\
    Strings & 255 & Yes & Yes \\
}
NOTE: The order of Data sections MUST be contiguous. A file is allowed to be divided in multiple sections, however a file header MUST NOT be divided.

\subsection{TypeExt}
Contains general information about the Package.
\bpxfieldtable
{
	Architecture & Unsigned & 8 & Target architecture \\
	Platform & Unsigned & 8 & Target platform \\
	Generator & Unsigned & 16 & Generator ID \\
	Reserved & Unsigned & 96 & Blank, always 0 \\
}
\begin{center}
	\begin{bytefield}[bitwidth=1.0em]{32}
		\bitheader{0-31} \\
		\begin{rightwordgroup}{128 bits}
			\bitbox{8}{Architecture} & \bitbox{8}{Platform} & \bitbox{16}{Generator} \\
			\bitbox{32}{Reserved} \\
			\bitbox{32}{Reserved} \\
			\bitbox{32}{Reserved}
		\end{rightwordgroup}
	\end{bytefield}
\end{center}

\subsubsection{Architecture}
8 bits of architecture stored as an enumeration. The current allowed values are:
\bpxtable{C|c}{Name & Value}
{
	x86\_64 & 0 \\
	aarch64 & 1 \\
	x86 & 2 \\
	armv7hl & 3 \\
	any & 4 \\
}

\subsubsection{Platform}
8 bits of platform stored as an enumeration. The current allowed values are:

\bpxtable{C|c}{Name & Value}
{
	Linux & 0 \\
	MacOS & 1 \\
	Windows & 2 \\
	Android & 3 \\
	Any & 4 \\
}

\subsubsection{Generator} \label{sssec:Generator}
16 bits of generator identification stored as 2 ASCII characters. The current allowed values are:

\bpxtable{C|c}{ASCII string & Notes}
{
	"PK" & Generated by FPKG \\
	"BP" & Generated by BlockProject 3D Engine \\
}

\subsection{Data}
The Data section is used to store one or more files. Each file begins by a file header which is defined as:

\bpxfieldtable
{
    Size & Unsigned & 64 & File size \\
    Path & Unsigned & 32 & Pointer in the Strings section \\
}

\subsubsection{Size}
The total size of the file to read. When extracting a file which size is greater than the remaining bytes in the section just continue reading from next section as if the next section was simply a continuation of the current one.

\subsubsection{Path}
The path as a pointer to a null terminated string in the strings section. Used to identify relative extraction location and/or the virtual path of the asset in a rendering application.

\subsection{Strings}
The strings section contains a list of null-terminated strings to be referenced by start offset from other sections (see \ref{ssec:Strings}).

\subsection{Metadata}
The metadata section contains generator specific information about the package. It is encoded as a Structured Data Section (see \ref{ssec:Structured}).
